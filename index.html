<!DOCTYPE html>
<html lang="es" ng-app="weddingApp">
<head>
    <meta charset="UTF-8">
    <title>Festival del Amor de Mari Virtu y Ricardo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-sanitize.js"></script>
    <script src="script.js"></script>
</head>
<body>

    <div ng-controller="WeddingController as wedding">
        <nav class="floating-menu" id="floatingMenu">
            <button class="menu-toggle" aria-expanded="false" aria-controls="menuLinks" title="Abrir men√∫">‚ò∞</button>
            <div class="menu-links" id="menuLinks">
                <a href="#lineup">Line-up</a>
                <a href="#ceremonia">Ceremonia</a>
                <a href="#banquete">Banquete</a>
                <a href="#itinerario">Itinerario</a>
                <a href="#galeria">Galer√≠a</a>
                <a href="#rsvp">Asistencia</a>
                <a href="#info-puntos">Info</a>
            </div>
        </nav>
        
        <button class="theme-toggle" ng-click="wedding.toggleTheme()" title="Cambiar tema">
            <span class="theme-icon">{{ wedding.isDarkMode ? '‚òÄÔ∏è' : 'üåô' }}</span>
        </button>
        <header class="hero">
            <div class="hero-content">
                <h1>¬°El festival del amor est√° aqu√≠!</h1>
                <p class="subtitle">Presentando a:</p>
                <h2>{{ wedding.brideName }} & {{ wedding.groomName }}</h2>
                <div class="event-info">
                    <span class="event-date">{{ wedding.ceremonyDate }} - {{ wedding.ceremonyTime }}</span>
                    <!-- <span class="event-location">{{ wedding.ceremonyPlace }} - {{wedding.ceremonyAddress}}</span> -->
                    <span class="event-location">{{wedding.ceremonyAddress}}</span>
                </div>
                <div class="countdown">
                    <span>{{ wedding.countdown.days }} d√≠as</span>
                    <span>{{ wedding.countdown.hours }} horas</span>
                    <span>{{ wedding.countdown.minutes }} min</span>
                </div>
                <a href="#info" class="cta-button" ng-click="wedding.scrollToLineUp(); $event.preventDefault();">Ver el Line-Up</a>
            </div>
        </header>

        <main id="info" class="container">

            <section class="section line-up" id="lineup">
                <h3>üéµ Line-up del festival</h3>
                <div class="headline-cards">
                    <div class="card headliner" style="background-image: url('assets/images/mvirtu.jpg');">
                        <h4>Cabeza de cartel</h4>
                        <p class="headliner-name">{{ wedding.brideName }}</p>
                    </div>
                    <div class="card headliner" style="background-image: url('assets/images/2_final.png');">
                        <h4>Cabeza de cartel</h4>
                        <p class="headliner-name">{{ wedding.groomName }}</p>
                    </div>
                </div>
                <p class="description">{{ wedding.descriptionText }}</p>
            </section>

            <!-- Secci√≥n historia del festival -->
            <section class="section festival-history" id="historia">
                <h3>üìñ Historia del Festival</h3>
                <p>
                    {{wedding.story}}
                </p>
            </section>

            <section class="section" id="ceremonia">
                <h3>üóìÔ∏è El Escenario Principal: La Ceremonia</h3>
                <p class="tba-title"><strong>TBA</strong></p>
                <p class="tba-subtitle">La organizaci√≥n del evento esta ultimando los detalles para establecer el lugar de la ceremonia de iniciaci√≥n del festival.</p>
                <!-- <p><strong>Hora:</strong> {{ wedding.ceremonyTime }}</p>
                <p><strong>Lugar:</strong> {{ wedding.ceremonyPlace }}</p>
                <button class="cta-button" ng-click="wedding.openLink(wedding.ceremonyHowToGo)">C√≥mo llegar</button> -->
            </section>

            <section class="section" id="banquete">
                <h3>üéâ La Zona VIP: El Banquete</h3>
                <p><strong>Hora de inicio:</strong> {{ wedding.partyTime }}</p>
                <p><strong>Lugar:</strong> {{ wedding.partyPlace }}</p>
                <p><strong>Aparcamiento:</strong> En las inmediaciones del recinto, al aire libre</p>
                <button class="cta-button" ng-click="wedding.openLink(wedding.partyHowToGo)">C√≥mo llegar</button>
                <button class="cta-button" ng-click="wedding.openLink(wedding.partyPlaceWebsite)">Web del lugar</button>
                
            </section>

            <!-- Secci√≥n itinerario tipo parrilla de festival -->
            <section class="section festival-schedule" id="itinerario">
                <h3>üïí Itinerario del Festival</h3>
                <div class="festival-grid">
                    <div class="festival-row">
                        <span class="festival-time">12:00</span>
                        <span class="festival-act">Ceremonia iniciaci√≥n</span>
                    </div>
                    <div class="festival-row">
                        <span class="festival-time">14:00</span>
                        <span class="festival-act">Banquete - Zona VIP</span>
                    </div>
                    <div class="festival-row">
                        <span class="festival-time">16:00</span>
                        <span class="festival-act">Baile - Main Stage</span>
                    </div>
                    <div class="festival-row">
                        <span class="festival-time">16:10</span>
                        <span class="festival-act">Dj - Main Stage</span>
                    </div>
                </div>
                <p>*Los horarios son aproximados y pueden sufrir modificaciones.</p>
            </section>

            <section class="section" id="galeria">
                <h3>üì∏ Galeria</h3>
                <div class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-4">
                    <img ng-repeat="foto in wedding.galeria" ng-src="{{foto.src}}" alt="Foto {{ $index + 1 }}" class="rounded-2xl w-full h-40 object-cover shadow"/>
                </div>
                <a ng-href="{{wedding.photoAlbumLink}}" class="cta-button" target="_blank" rel="noopener">Comparte con nosotros las fotos del evento</a>
            </section>

            <section class="section" id="rsvp">
                <h3>üíå Confirma tu asistencia</h3>
                <p>¬°No podemos esperar a verte! Por favor, confirma tu asistencia antes del {{ wedding.rsvpDeadline }} para que podamos organizarlo todo.</p>
                <form ng-submit="wedding.submitRSVP()">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="rsvp-name">Nombre y apellidos</label>
                            <input id="rsvp-name" type="text" ng-model="wedding.rsvp.nombre" placeholder="Tu nombre y apellidos" required>
                        </div>
                        <div class="form-group">
                            <label for="rsvp-email">Email</label>
                            <input id="rsvp-email" type="email" ng-model="wedding.rsvp.email" placeholder="Tu email" required>
                        </div>
                        <div class="form-group">
                            <label for="attendance-select">Asistencia</label>
                            <select id="attendance-select" ng-model="wedding.rsvp.asistencia" required>
                                <option value="" disabled hidden selected>Selecciona una opci√≥n</option>
                                <option value="asistire">Asistir√©</option>
                                <option value="no-asistire">No podr√© asistir</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rsvp-alergias">Alergias/Intolerancias</label>
                            <input id="rsvp-alergias" type="text" ng-model="wedding.rsvp.alergias" placeholder="Alergias/Intolerancias" required>
                        </div>
                        <div class="form-group full-width">
                            <label for="rsvp-message">Mensaje para los novios</label>
                            <textarea id="rsvp-message" ng-model="wedding.rsvp.mensaje" placeholder="Escribe tu mensaje" required></textarea>
                        </div>
                    </div>
                    <button type="submit" class="cta-button" ng-disabled="wedding.enviando">{{ wedding.enviando ? 'Enviando...' : 'Enviar confirmaci√≥n' }}</button>
                    <p ng-show="wedding.message" class="{{ wedding.messageClass }}" id="form-message">{{ wedding.message }}</p>
                </form>
                <p ng-show="wedding.message" class="{{ wedding.messageClass }}">{{ wedding.message }}</p>
            </section>

            <section class="section" id="info-puntos">
                <h3>üéÅ Puntos de informaci√≥n</h3>
                <div class="faq-container">
                    <div class="faq-item" ng-repeat="faq in wedding.faqs" ng-class="{'active': faq.isOpen}">
                        <div class="faq-question" ng-click="wedding.toggleFaq($index)">
                            <h4>{{ faq.question }}</h4>
                            <span class="faq-icon">{{ faq.isOpen ? '‚àí' : '+' }}</span>
                        </div>
                        <div class="faq-answer" ng-show="faq.isOpen">
                            <p ng-bind-html="faq.answer"></p>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer>
            <p>&copy; 2026 Festival del Amor. Creado con mucho cari√±o por {{ wedding.groomName }} & {{ wedding.brideName }}.</p>
        </footer>
    </div>
</main>
<script>
(function() {
    var nav = document.getElementById('floatingMenu');
    if (!nav) return;
    var btn = nav.querySelector('.menu-toggle');
    var links = nav.querySelector('.menu-links');
    // Estado inicial seg√∫n ancho de pantalla
    function isDesktop() { return window.matchMedia('(min-width: 768px)').matches; }
    function setState(open) {
        if (!nav) return;
        if (open) { nav.classList.add('open'); } else { nav.classList.remove('open'); }
        if (btn) {
            btn.setAttribute('aria-expanded', open ? 'true' : 'false');
            btn.textContent = open ? '√ó' : '‚ò∞';
            btn.title = open ? 'Cerrar men√∫' : 'Abrir men√∫';
        }
    }
    // Inicializar estado
    setState(isDesktop());
    if (btn) {
        btn.addEventListener('click', function() {
            setState(!nav.classList.contains('open'));
        });
    }
    if (links) {
        links.addEventListener('click', function(e) {
            if (e.target && e.target.tagName === 'A') {
                setState(false);
            }
        });
    }
    // Actualizar estado al cambiar el tama√±o de la ventana
    window.addEventListener('resize', function() {
        setState(isDesktop());
    });
})();

// Resaltado de secci√≥n activa en el men√∫
(function() {
    var nav = document.getElementById('floatingMenu');
    if (!nav) return;
    var linkNodes = Array.prototype.slice.call(nav.querySelectorAll('.menu-links a'));
    if (!linkNodes.length) return;
    var anchors = linkNodes
        .map(function(a){ var id = (a.getAttribute('href')||'').replace('#',''); return { a: a, id: id, el: document.getElementById(id) }; })
        .filter(function(x){ return !!x.el; });
    if (!anchors.length) return;
    var active = null;
    function setActive(id) {
        if (active === id) return;
        active = id;
        linkNodes.forEach(function(n){ n.classList.toggle('active', (n.getAttribute('href')||'') === '#' + id); });
    }
    var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                setActive(entry.target.id);
            }
        });
    }, { root: null, rootMargin: '0px 0px -60% 0px', threshold: 0.25 });
    anchors.forEach(function(x){ observer.observe(x.el); });
})();
</script>
</body>
</html>